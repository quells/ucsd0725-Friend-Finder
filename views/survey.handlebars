<h3 class="center-align">Compatibility Survey</h3>
<div class="row">
    <div class="col s0 m1 l2 xl3"></div>
    <form class="col s12 m10 l8 xl6" action="/api/submit_survey" method="post" id="surveyForm">
        <div class="row">
            <div class="input-field col s12">
                <i class="material-icons prefix">account_circle</i>
                <input type="text" name="userName" class="validate" id="userName" />
                <label for="userName">Your Name</label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col s12">
                <input type="text" name="userImage" class="" id="userImage" placeholder="Enter a URL for a profile image" />
                <label for="userImage">Your Profile Image</label>
            </div>
        </div>
        {{#each questions}}
        <div class="row">
            <div class="col s12">
                <p>{{this}}</p>
                <p class="range-field">
                    <input type="range" name="q{{@index}}" value="3" min="1" max="5">
                </p>
            </div>
        </div>
        {{/each}}
        <div class="row">
            <div class="input-field col s12">
                <button type="submit" class="waves-effect waves-light btn" id="submitSurvey">Submit</button>
            </div>
        </div>
    </form>
</div>
<script type="text/javascript">
$(function() {
    var userNameField = $("#userName");
    var userImageField = $("#userImage");

    userImageField.on("change", function() {
        userImageField.attr("class", "");
        console.log(userImageField.val())
        $.get(userImageField.val(), function(response) {
            console.log(response)
        })
    });

    $("#submitSurvey").click(function(e) {
        e.preventDefault();
        if (userNameField.val().length < 1) {
            alert("Please enter your name.")
            return
        }
        $.ajax({
            type: "POST",
            url: "/api/submit_survey",
            data: $("#surveyForm").serialize(),
            success: function(data) {
                $("#surveyForm").find("input").prop("disabled", true)
                $("#surveyForm").find("button").prop("disabled", true)
                console.log(data)
            }
        });
    });
});
</script>
